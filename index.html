<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HK Stock and Option Explorer | Real HKEX Data</title>
  <meta name="description"
    content="Explore Hong Kong stock and options with real HKEX settlement data. Predict stock prices, analyze options chains, and build trading strategies.">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link
    href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
    rel="stylesheet">
  <link rel="stylesheet" href="/src/index.css">
</head>

<body>
  <!-- Password Gate -->
  <div id="authGate" class="auth-gate">
    <div class="auth-card">
      <div class="auth-icon">â—†</div>
      <h2>HK Stock & Option <span class="accent">Explorer</span></h2>
      <p class="auth-subtitle">Enter password to access the application</p>
      <div class="auth-form">
        <input type="password" id="authPassword" class="auth-input" placeholder="Password" autocomplete="off">
        <button class="btn btn-primary auth-btn" id="authSubmit">Unlock</button>
      </div>
      <p class="auth-error" id="authError"></p>
      <p class="auth-footer">Proof of Concept Â· Not Financial Advice</p>
    </div>
  </div>

  <div id="app" style="display:none">
    <!-- Header -->
    <header class="app-header">
      <div class="header-left">
        <div class="logo">
          <span class="logo-icon">â—†</span>
          <h1>HK Stock & Option <span class="accent">Explorer</span></h1>
        </div>
        <span class="badge">HKEX DTOP Data</span>
      </div>
      <div class="header-right">
        <div class="stock-selector" id="stockSelectorWrap">
          <label for="stockSelector">Stock</label>
          <select id="stockSelector">
            <option value="">Loading...</option>
          </select>
        </div>
        <div class="date-selector">
          <label for="dateSelector">Date</label>
          <select id="dateSelector">
            <option value="">Loading...</option>
          </select>
        </div>
      </div>
    </header>

    <!-- â•â•â•â•â•â• MAIN TABS â•â•â•â•â•â• -->
    <nav class="tabs" id="tabs">
      <button class="tab active" data-tab="stock-analysis">
        <span class="tab-icon">ğŸ“Š</span> Stock Analysis
      </button>
      <button class="tab" data-tab="options-explorer">
        <span class="tab-icon">â›“ï¸</span> Options Explorer
      </button>
      <button class="tab" data-tab="strategy">
        <span class="tab-icon">ğŸ¯</span> Strategy Builder
      </button>
    </nav>

    <!-- Tab Content -->
    <main class="content">

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <!-- â•â•â• TAB 1: STOCK ANALYSIS (with sub-tabs)            â•â•â• -->
      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="tab-panel active" id="panel-stock-analysis">

        <nav class="sub-tabs" id="stockSubTabs">
          <button class="sub-tab active" data-subtab="sub-sarimax">
            <span class="sub-tab-icon">ğŸ”®</span> SARIMAX
          </button>
          <button class="sub-tab" data-subtab="sub-hybrid">
            <span class="sub-tab-icon">ğŸ§¬</span> Hybrid SARIMAX+LSTM
          </button>
          <button class="sub-tab" data-subtab="sub-candlestick">
            <span class="sub-tab-icon">ğŸ•¯ï¸</span> Candlestick
          </button>
        </nav>

        <!-- Sub-Panel: SARIMAX -->
        <div class="sub-panel active" id="sub-sarimax">
          <div class="card">
            <h2>ğŸ”® SARIMAX Price Prediction</h2>
            <p class="card-subtitle">LLM-Sentiment-Enhanced SARIMAX model vs Traditional SARIMAX â€” comparing forecast
              accuracy with and without news sentiment</p>
            <div class="sarimax-controls">
              <div>
                <label for="sarimaxHorizon">Forecast Horizon</label>
                <select id="sarimaxHorizon" class="select">
                  <option value="5">5 days</option>
                  <option value="10" selected>10 days</option>
                  <option value="20">20 days</option>
                </select>
              </div>
              <button id="btnRunSarimax" class="btn btn-primary">
                <span class="tab-icon">âš¡</span> Run Prediction
              </button>
            </div>
          </div>

          <!-- Chart -->
          <div class="card">
            <h3>ğŸ“Š Stock Price Forecast</h3>
            <div class="sarimax-chart-container">
              <canvas id="sarimaxChart"></canvas>
            </div>
            <div id="sarimaxChartNote" class="chart-note"></div>
          </div>

          <!-- Model Comparison -->
          <div class="sarimax-comparison" id="sarimaxComparison" style="display:none;">
            <div class="card">
              <h3>ğŸŸ¢ Sentiment-Enhanced SARIMAX</h3>
              <p class="model-subtitle">SARIMAX(0,1,2) + sentiment + volume</p>
              <div class="metric-row">
                <div class="bt-stat"><span class="bt-label">MAE</span><span class="bt-value" id="enhMAE">â€”</span></div>
                <div class="bt-stat"><span class="bt-label">RMSE</span><span class="bt-value" id="enhRMSE">â€”</span>
                </div>
                <div class="bt-stat"><span class="bt-label">MAPE</span><span class="bt-value" id="enhMAPE">â€”</span>
                </div>
              </div>
            </div>
            <div class="card">
              <h3>ğŸŸ  Traditional SARIMAX</h3>
              <p class="model-subtitle">SARIMAX(0,1,2) â€” no exogenous variables</p>
              <div class="metric-row">
                <div class="bt-stat"><span class="bt-label">MAE</span><span class="bt-value" id="tradMAE">â€”</span></div>
                <div class="bt-stat"><span class="bt-label">RMSE</span><span class="bt-value" id="tradRMSE">â€”</span>
                </div>
                <div class="bt-stat"><span class="bt-label">MAPE</span><span class="bt-value" id="tradMAPE">â€”</span>
                </div>
              </div>
            </div>
          </div>

          <!-- Sentiment Summary -->
          <div class="card" id="sarimaxSentiment" style="display:none;">
            <h3>ğŸ“° News Sentiment Input</h3>
            <div class="sentiment-summary">
              <div class="bt-stat"><span class="bt-label">ğŸ“ˆ Bullish Days</span><span class="bt-value" id="sentBull"
                  style="color:var(--accent-green)">â€”</span></div>
              <div class="bt-stat"><span class="bt-label">ğŸ“‰ Bearish Days</span><span class="bt-value" id="sentBear"
                  style="color:var(--accent-red)">â€”</span></div>
              <div class="bt-stat"><span class="bt-label">âš–ï¸ Neutral Days</span><span class="bt-value" id="sentNeut"
                  style="color:var(--text-muted)">â€”</span></div>
              <div class="bt-stat"><span class="bt-label">ğŸ“Š Total Days</span><span class="bt-value"
                  id="sentTotal">â€”</span></div>
            </div>
            <p class="sarimax-note">Sentiment scores (+1/0/âˆ’1) derived from Yahoo Finance news headlines using
              lexicon-based analysis, following the poster's methodology.</p>
          </div>

          <!-- Educational Section -->
          <details class="edu-section card">
            <summary class="edu-toggle">ğŸ“š SARIMAX Methodology & Formulas</summary>
            <div class="edu-content">
              <div class="edu-grid">
                <div class="edu-block">
                  <h4>ğŸ“– What is SARIMAX?</h4>
                  <p><strong>SARIMAX</strong> = Seasonal Auto-Regressive Integrated Moving Average with eXogenous
                    variables.</p>
                  <p>It extends ARIMA by adding:</p>
                  <div class="edu-formula">SARIMAX(p, d, q) Ã— (P, D, Q, s)<br><br>p = # autoregressive terms<br>d = #
                    differencing passes<br>q = # moving average terms<br>P, D, Q = seasonal equivalents<br>s = seasonal
                    period<br><br>Our config: SARIMAX(0,1,2)Ã—(0,0,0,0)</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸ§  The Enhanced Model</h4>
                  <p>Following Li Zhaohang's research (2026), the enhanced model adds two exogenous variables:</p>
                  <div class="edu-formula">y_t = c + Î£Ï†_iÂ·y_{t-i} + Î£Î¸_jÂ·Îµ_{t-j} + Î£Î²_kÂ·X_{k,t} + Îµ_t<br><br>Xâ‚ =
                    Normalized Trading Volume<br>Xâ‚‚ = News Sentiment Score (+1/0/âˆ’1)</div>
                  <p class="edu-hint">ğŸ“Œ Key finding: Real-time sentiment slightly improves short-term accuracy; lagged
                    sentiment degrades it.</p>
                </div>
                <div class="edu-block">
                  <h4>ğŸ“ Evaluation Metrics</h4>
                  <div class="edu-formula">MAE = (1/n) Î£|actual_i âˆ’ predicted_i|<br><br>RMSE = âˆš[(1/n) Î£(actual_i âˆ’
                    predicted_i)Â²]<br><br>MAPE = (100/n) Î£|actual_i âˆ’ predicted_i| / |actual_i|</div>
                  <p class="edu-hint">âš ï¸ Lower values = better prediction. Compare Enhanced vs Traditional to see if
                    sentiment helps.</p>
                </div>
                <div class="edu-block">
                  <h4>ğŸ“š Reference</h4>
                  <p>Li, Z.H. (2026). <em>Price prediction of Nasdaq 100 Index Fund: A comparison between
                      LLM-Sentiment-Enhanced SARIMAX model and traditional SARIMAX model.</em> Unpublished manuscript,
                    The
                    Hong Kong Polytechnic University.</p>
                </div>
              </div>
            </div>
          </details>
        </div>

        <!-- Sub-Panel: Hybrid -->
        <div class="sub-panel" id="sub-hybrid">
          <div class="eq-card">
            <h3>ğŸ§¬ Hybrid SARIMAX + LSTM</h3>
            <p class="eq-card-subtitle">Improvement over pure SARIMAX: LSTM learns non-linear residual patterns that
              SARIMAX misses. Final forecast = SARIMAX prediction + LSTM residual correction.</p>
            <div class="eq-controls">
              <div>
                <label for="hybridHorizon">Forecast Horizon</label>
                <select id="hybridHorizon" class="eq-select">
                  <option value="5">5 days</option>
                  <option value="10" selected>10 days</option>
                  <option value="15">15 days</option>
                  <option value="20">20 days</option>
                </select>
              </div>
              <button id="btnRunHybrid" class="eq-btn">âš¡ Run Hybrid Model</button>
            </div>
          </div>

          <!-- Hybrid Chart -->
          <div class="eq-card">
            <h3>ğŸ“ˆ Three-Model Forecast Comparison</h3>
            <div class="eq-chart-container">
              <canvas id="hybridChart"></canvas>
            </div>
            <p id="hybridChartNote" class="eq-note">Select a stock and click "Run Hybrid Model" to generate predictions.
            </p>
          </div>

          <!-- Three-model comparison -->
          <div id="hybridComparison" class="eq-comparison" style="display:none">
            <div class="eq-card">
              <h4>ğŸŸ¢ Hybrid (SARIMAX+LSTM)</h4>
              <p class="eq-model-sub">SARIMAX(0,1,2) + LSTM residual correction</p>
              <div class="eq-metric-row">
                <div class="eq-metric"><span class="eq-metric-label">MAE</span><span id="hybMAE"
                    class="eq-metric-value">â€”</span></div>
                <div class="eq-metric"><span class="eq-metric-label">RMSE</span><span id="hybRMSE"
                    class="eq-metric-value">â€”</span></div>
                <div class="eq-metric"><span class="eq-metric-label">MAPE</span><span id="hybMAPE"
                    class="eq-metric-value">â€”</span></div>
              </div>
            </div>
            <div class="eq-card">
              <h4>ğŸŸ  SARIMAX Only</h4>
              <p class="eq-model-sub">SARIMAX(0,1,2) + sentiment + volume</p>
              <div class="eq-metric-row">
                <div class="eq-metric"><span class="eq-metric-label">MAE</span><span id="hybSarMAE"
                    class="eq-metric-value">â€”</span></div>
                <div class="eq-metric"><span class="eq-metric-label">RMSE</span><span id="hybSarRMSE"
                    class="eq-metric-value">â€”</span></div>
                <div class="eq-metric"><span class="eq-metric-label">MAPE</span><span id="hybSarMAPE"
                    class="eq-metric-value">â€”</span></div>
              </div>
            </div>
            <div class="eq-card full-width">
              <h4>ğŸŸ£ Traditional SARIMAX</h4>
              <p class="eq-model-sub">SARIMAX(0,1,2) â€” no exogenous variables</p>
              <div class="eq-metric-row">
                <div class="eq-metric"><span class="eq-metric-label">MAE</span><span id="hybTradMAE"
                    class="eq-metric-value">â€”</span></div>
                <div class="eq-metric"><span class="eq-metric-label">RMSE</span><span id="hybTradRMSE"
                    class="eq-metric-value">â€”</span></div>
                <div class="eq-metric"><span class="eq-metric-label">MAPE</span><span id="hybTradMAPE"
                    class="eq-metric-value">â€”</span></div>
              </div>
            </div>
          </div>

          <!-- Methodology -->
          <details class="edu-section eq-card">
            <summary class="edu-toggle">ğŸ“š Hybrid Model Methodology & Formulas</summary>
            <div class="edu-content">
              <div class="edu-grid">
                <div class="edu-block">
                  <h4>ğŸ”¬ Why Hybrid?</h4>
                  <p>SARIMAX captures <strong>linear</strong> patterns, but stock prices also contain
                    <strong>non-linear</strong> patterns. The hybrid approach:
                  </p>
                  <div class="edu-formula">Å·_t = SARIMAX(t) + LSTM(residuals_t)<br><br>residual_t = actual_t âˆ’
                    SARIMAX(t)<br><br>The LSTM learns patterns in these "mistakes"<br>that the statistical model cannot
                    capture.</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸ§  LSTM Architecture</h4>
                  <div class="edu-formula">Input: sliding windows of residuals (lookback=10)<br>â†’ LSTM(24 units) + 15%
                    Dropout<br>â†’ Dense(12, ReLU)<br>â†’ Dense(1, Linear) = residual prediction<br><br>Training: 30 epochs,
                    Adam (lr=0.005)<br>Loss: Mean Squared Error</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸ“š Reference</h4>
                  <p>Zhang, G.P. (2003). <em>Time series forecasting using a hybrid ARIMA and neural network model.</em>
                    Neurocomputing, 50, 159-175.</p>
                </div>
              </div>
            </div>
          </details>
        </div>

        <!-- Sub-Panel: Candlestick -->
        <div class="sub-panel" id="sub-candlestick">
          <div class="candle-controls card">
            <h3>ğŸ•¯ï¸ Candlestick Pattern Scanner</h3>
            <div class="candle-selectors">
              <div>
                <label for="candleExpiry">Expiry</label>
                <select id="candleExpiry">
                  <option>Select stock first</option>
                </select>
              </div>
              <div>
                <label for="candleStrike">Strike</label>
                <select id="candleStrike">
                  <option>Select expiry first</option>
                </select>
              </div>
              <div>
                <label for="candleType">Type</label>
                <select id="candleType">
                  <option value="call">Call</option>
                  <option value="put">Put</option>
                </select>
              </div>
              <button class="btn btn-primary" id="btnScanPatterns">ğŸ” Scan Patterns</button>
            </div>
          </div>

          <div class="candle-chart-wrap card">
            <h3>ğŸ“Š Candlestick Chart</h3>
            <div class="candle-chart-container">
              <canvas id="candlestickChart"></canvas>
            </div>
            <p class="placeholder-text" id="candlePlaceholder">Select an option above and click "Scan Patterns" to
              generate the chart</p>
          </div>

          <div class="candle-results">
            <div class="card">
              <h3>ğŸ” Detected Patterns</h3>
              <div id="patternList">
                <p class="placeholder-text">Patterns will appear after scanning</p>
              </div>
            </div>
            <div class="card">
              <h3>ğŸ“ˆ Backtest Results</h3>
              <div id="backtestResults">
                <p class="placeholder-text">Backtest results will appear after scanning</p>
              </div>
            </div>
          </div>

          <details class="edu-section card">
            <summary class="edu-toggle">ğŸ“š Candlestick Patterns & Formulas</summary>
            <div class="edu-content">
              <div class="edu-grid">
                <div class="edu-block">
                  <h4>ğŸ“– What Are Candlesticks?</h4>
                  <p>A candlestick shows 4 prices for a period: <strong>Open, High, Low, Close</strong> (OHLC).</p>
                  <div class="edu-formula">Body = |Close âˆ’ Open| (filled rectangle)<br>Upper Wick = High âˆ’ max(O,
                    C)<br>Lower Wick = min(O, C) âˆ’ Low<br><br>ğŸŸ¢ Green = Close &gt; Open (bullish)<br>ğŸ”´ Red = Close
                    &lt;
                    Open (bearish)</div>
                  <p>Patterns formed by 1â€“3 candles can signal potential reversals or continuations.</p>
                </div>
                <div class="edu-block">
                  <h4>âœš Doji</h4>
                  <p>Open â‰ˆ Close (tiny body). Signals <strong>market indecision</strong> and a potential reversal.</p>
                  <p class="edu-hint">ğŸ“Œ Most significant at trend extremes. Confirm with next candle.</p>
                </div>
                <div class="edu-block">
                  <h4>ğŸ”¨ Hammer &amp; ğŸŒ  Shooting Star</h4>
                  <p><strong>Hammer:</strong> Small body + long lower shadow (â‰¥2Ã— body) in a <em>downtrend</em> â†’
                    bullish reversal.</p>
                  <p><strong>Shooting Star:</strong> Small body + long upper shadow in an <em>uptrend</em> â†’ bearish
                    reversal.</p>
                  <div class="edu-formula">Hammer condition:<br>lower_shadow â‰¥ 2 Ã— body_size<br>upper_shadow â‰¤ body_size
                    Ã— 0.3</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸŸ¢ Engulfing Patterns</h4>
                  <p><strong>Bullish:</strong> Large green candle completely engulfs previous red candle â†’ reversal up.
                  </p>
                  <p><strong>Bearish:</strong> Large red candle completely engulfs previous green candle â†’ reversal
                    down.</p>
                  <div class="edu-formula">Bullish Engulfing:<br>candle[i].close &gt; candle[i-1].open
                    AND<br>candle[i].open &lt; candle[i-1].close AND<br>candle[i-1] is bearish</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸŒ… Morning Star &amp; ğŸŒ† Evening Star</h4>
                  <p><strong>Morning Star:</strong> Red â†’ small body â†’ Green (dawn of a rally)</p>
                  <p><strong>Evening Star:</strong> Green â†’ small body â†’ Red (dusk before decline)</p>
                  <p class="edu-hint">ğŸ“Œ The small middle candle represents the "turning point" of sentiment.</p>
                </div>
                <div class="edu-block">
                  <h4>âš ï¸ Important Notes</h4>
                  <p>â€¢ OHLC here is <strong>synthetic</strong> â€” derived from daily settlement prices, not live market
                    data</p>
                  <p>â€¢ Always <strong>confirm</strong> patterns with volume, support/resistance, and other indicators
                  </p>
                  <p>â€¢ Backtest win rates are based on a simple 3-day hold strategy</p>
                </div>
              </div>
            </div>
          </details>
        </div>

      </section>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <!-- â•â•â• TAB 2: OPTIONS EXPLORER (with sub-tabs)          â•â•â• -->
      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="tab-panel" id="panel-options-explorer">

        <nav class="sub-tabs" id="optionsSubTabs">
          <button class="sub-tab active" data-subtab="sub-dashboard">
            <span class="sub-tab-icon">ğŸ“‹</span> Dashboard
          </button>
          <button class="sub-tab" data-subtab="sub-chain">
            <span class="sub-tab-icon">â›“ï¸</span> Options Chain
          </button>
          <button class="sub-tab" data-subtab="sub-trends">
            <span class="sub-tab-icon">ğŸ“ˆ</span> Trend Analysis
          </button>
          <button class="sub-tab" data-subtab="sub-prediction">
            <span class="sub-tab-icon">ğŸ¤–</span> AI Prediction
          </button>
        </nav>

        <!-- Sub-Panel: Dashboard -->
        <div class="sub-panel active" id="sub-dashboard">
          <div class="dashboard-stats" id="dashboardStats"></div>
          <div class="dashboard-grid">
            <div class="card" id="topStocksCard">
              <h3>Top Stocks by Open Interest</h3>
              <div id="topStocksTable"></div>
            </div>
            <div class="card" id="marketOverviewCard">
              <h3>Market Overview</h3>
              <canvas id="marketChart"></canvas>
            </div>
          </div>
          <details class="edu-section card">
            <summary class="edu-toggle">ğŸ“š Options Basics â€” What Are Stock Options?</summary>
            <div class="edu-content">
              <div class="edu-grid">
                <div class="edu-block">
                  <h4>ğŸ“ What is an Option?</h4>
                  <p>An option gives you the <strong>right (not obligation)</strong> to buy or sell a stock at a set
                    price
                    (the <em>strike price</em>) before a specific date (the <em>expiry</em>).</p>
                  <div class="edu-formula">Premium = Intrinsic Value + Time Value<br><br>Intrinsic (Call) = max(S âˆ’ K,
                    0)<br>Intrinsic (Put) = max(K âˆ’ S, 0)<br>Time Value = Premium âˆ’ Intrinsic Value</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸ“ Call vs ğŸ“‰ Put</h4>
                  <p><strong>Call Option</strong> â€” Right to <em>buy</em> the stock. You profit if the stock goes up.
                  </p>
                  <p><strong>Put Option</strong> â€” Right to <em>sell</em> the stock. You profit if the stock goes down.
                  </p>
                </div>
                <div class="edu-block">
                  <h4>ğŸ’° Key Terms</h4>
                  <table class="edu-table">
                    <tr>
                      <td><strong>Strike Price (K)</strong></td>
                      <td>The price at which you can buy/sell the stock</td>
                    </tr>
                    <tr>
                      <td><strong>Expiry Date</strong></td>
                      <td>The deadline for exercising the option</td>
                    </tr>
                    <tr>
                      <td><strong>Premium</strong></td>
                      <td>The price you pay to buy the option</td>
                    </tr>
                    <tr>
                      <td><strong>Open Interest (OI)</strong></td>
                      <td>Total number of outstanding contracts</td>
                    </tr>
                    <tr>
                      <td><strong>Settlement Price</strong></td>
                      <td>Official closing price from the exchange (SEOCH)</td>
                    </tr>
                  </table>
                </div>
                <div class="edu-block">
                  <h4>ğŸ¯ Moneyness</h4>
                  <table class="edu-table">
                    <tr>
                      <td><strong>In The Money (ITM)</strong></td>
                      <td>Call: S &gt; K Â· Put: S &lt; K â€” has intrinsic value</td>
                    </tr>
                    <tr>
                      <td><strong>At The Money (ATM)</strong></td>
                      <td>S â‰ˆ K â€” strike near current price</td>
                    </tr>
                    <tr>
                      <td><strong>Out of The Money (OTM)</strong></td>
                      <td>Call: S &lt; K Â· Put: S &gt; K â€” no intrinsic value</td>
                    </tr>
                  </table>
                </div>
              </div>
            </div>
          </details>
        </div>

        <!-- Sub-Panel: Options Chain -->
        <div class="sub-panel" id="sub-chain">
          <div class="chain-controls">
            <div class="expiry-selector">
              <label for="expirySelector">Expiry</label>
              <select id="expirySelector">
                <option value="">Select a stock first</option>
              </select>
            </div>
            <div class="chain-info" id="chainInfo"></div>
          </div>
          <div class="card chain-table-wrap">
            <div class="chain-table-container" id="chainTableContainer">
              <p class="placeholder-text">Select a stock and expiry to view the options chain</p>
            </div>
          </div>
          <details class="edu-section card">
            <summary class="edu-toggle">ğŸ“š Reading the Options Chain & Implied Volatility</summary>
            <div class="edu-content">
              <div class="edu-grid">
                <div class="edu-block">
                  <h4>ğŸ“– How to Read the Table</h4>
                  <p>The options chain shows <strong>calls on the left</strong> and <strong>puts on the right</strong>,
                    with the <strong>strike price in the center</strong>.</p>
                  <table class="edu-table">
                    <tr>
                      <td><strong>Settle</strong></td>
                      <td>Official settlement (closing) price from SEOCH</td>
                    </tr>
                    <tr>
                      <td><strong>Chg</strong></td>
                      <td>Price change from previous day's settlement</td>
                    </tr>
                    <tr>
                      <td><strong>IV</strong></td>
                      <td>Implied Volatility â€” market's expected future volatility (higher = more expensive)</td>
                    </tr>
                    <tr>
                      <td><strong>Volume</strong></td>
                      <td>Number of contracts traded today</td>
                    </tr>
                    <tr>
                      <td><strong>OI</strong></td>
                      <td>Open Interest â€” total outstanding contracts (higher = more liquid)</td>
                    </tr>
                  </table>
                </div>
                <div class="edu-block">
                  <h4>ğŸ“ Implied Volatility (IV)</h4>
                  <p>IV represents the market's expectation of future price movement, <em>implied</em> from the option
                    price using Black-Scholes:</p>
                  <div class="edu-formula">Given the market price, solve for Ïƒ in:<br>C = SÂ·N(dâ‚) âˆ’
                    KÂ·eâ»Ê³áµ€Â·N(dâ‚‚)<br><br>Higher IV â†’ more expensive options (more uncertainty)</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸ’¡ Tips for Beginners</h4>
                  <p>â€¢ <strong>High OI + High Volume</strong> = liquid contract (easier to trade)</p>
                  <p>â€¢ <strong>ATM options</strong> have the most time value</p>
                  <p>â€¢ <strong>Deep ITM</strong> options behave like the stock itself</p>
                  <p>â€¢ <strong>OTM options</strong> are cheaper but expire worthless more often</p>
                </div>
              </div>
            </div>
          </details>
        </div>

        <!-- Sub-Panel: Trend Analysis -->
        <div class="sub-panel" id="sub-trends">
          <div class="trends-grid">
            <div class="card">
              <h3>Settlement Price History</h3>
              <div class="trends-controls">
                <select id="trendExpiry">
                  <option>Select stock first</option>
                </select>
                <select id="trendStrike">
                  <option>Select expiry first</option>
                </select>
                <select id="trendType">
                  <option value="call">Call</option>
                  <option value="put">Put</option>
                </select>
              </div>
              <canvas id="settlementChart"></canvas>
            </div>
            <div class="card">
              <h3>Open Interest Over Time</h3>
              <canvas id="oiChart"></canvas>
            </div>
            <div class="card">
              <h3>Put/Call Ratio</h3>
              <canvas id="pcrChart"></canvas>
            </div>
            <div class="card">
              <h3>Volume Analysis</h3>
              <canvas id="volumeChart"></canvas>
            </div>
          </div>
          <details class="edu-section card">
            <summary class="edu-toggle">ğŸ“š Understanding Trend Indicators & Formulas</summary>
            <div class="edu-content">
              <div class="edu-grid">
                <div class="edu-block">
                  <h4>ğŸ“ˆ Settlement Price Trends</h4>
                  <p>The settlement price is the official closing price set by SEOCH. Tracking it over time reveals the
                    market's valuation trend for a specific option.</p>
                  <p>â€¢ <strong>Rising settlement</strong> = increasing demand / bullish sentiment</p>
                  <p>â€¢ <strong>Falling settlement</strong> = decreasing demand / bearish sentiment</p>
                </div>
                <div class="edu-block">
                  <h4>ğŸ“Š Open Interest (OI)</h4>
                  <p>OI = total number of outstanding option contracts. Changes in OI signal money flow:</p>
                  <table class="edu-table">
                    <tr>
                      <td><strong>Rising OI + Rising Price</strong></td>
                      <td>New money entering â†’ Trend confirmation</td>
                    </tr>
                    <tr>
                      <td><strong>Rising OI + Falling Price</strong></td>
                      <td>New shorts entering â†’ Bearish pressure</td>
                    </tr>
                    <tr>
                      <td><strong>Falling OI + Rising Price</strong></td>
                      <td>Short covering â†’ Weak rally</td>
                    </tr>
                    <tr>
                      <td><strong>Falling OI + Falling Price</strong></td>
                      <td>Long liquidation â†’ Weak decline</td>
                    </tr>
                  </table>
                </div>
                <div class="edu-block">
                  <h4>âš–ï¸ Put/Call Ratio (PCR)</h4>
                  <p>PCR measures market sentiment by comparing put volume/OI to call volume/OI:</p>
                  <div class="edu-formula">PCR = Put OI / Call OI<br><br>PCR &lt; 0.7 â†’ Bullish sentiment<br>PCR â‰ˆ 1.0 â†’
                    Neutral<br>PCR &gt; 1.3 â†’ Bearish sentiment<br>Extreme PCR â†’ Contrarian signal</div>
                </div>
              </div>
            </div>
          </details>
        </div>

        <!-- Sub-Panel: AI Prediction -->
        <div class="sub-panel" id="sub-prediction">
          <div class="prediction-controls">
            <div class="card prediction-config">
              <h3>ğŸ§  LSTM Configuration</h3>
              <div class="pred-form-row">
                <div class="form-group">
                  <label for="predExpiry">Expiry</label>
                  <select id="predExpiry">
                    <option>Select stock first</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="predStrike">Strike (ATM)</label>
                  <select id="predStrike">
                    <option>Select expiry first</option>
                  </select>
                </div>
                <div class="form-group">
                  <label for="predType">Option Type</label>
                  <select id="predType">
                    <option value="call">Call</option>
                    <option value="put">Put</option>
                  </select>
                </div>
              </div>
              <div class="pred-form-row">
                <div class="form-group">
                  <label for="predLookback">Lookback (days)</label>
                  <input type="number" id="predLookback" value="10" min="3" max="30">
                </div>
                <div class="form-group">
                  <label for="predForecast">Forecast (days)</label>
                  <input type="number" id="predForecast" value="5" min="1" max="15">
                </div>
                <div class="form-group">
                  <label for="predEpochs">Epochs</label>
                  <input type="number" id="predEpochs" value="50" min="10" max="200">
                </div>
              </div>
              <button class="btn btn-primary" id="runLstmBtn">
                <span id="runLstmBtnText">âš¡ Run AI Prediction</span>
              </button>
              <div class="progress-bar-wrap" id="progressWrap" style="display:none">
                <div class="progress-bar" id="progressBar"></div>
                <span class="progress-text" id="progressText">Training...</span>
              </div>
            </div>

            <div class="card signal-card" id="signalCard">
              <h3>ğŸ“¡ LSTM Signal</h3>
              <div id="signalContent">
                <p class="placeholder-text">Run the model to get predictions</p>
              </div>
            </div>
          </div>

          <!-- Parallel Predictions Row -->
          <div class="prediction-dual">
            <div class="card">
              <h3>ğŸ“Š Settlement Price Prediction</h3>
              <canvas id="predictionChart"></canvas>
            </div>
            <div class="card news-card" id="newsCard">
              <h3>ğŸ“° News Sentiment</h3>
              <div id="newsContent">
                <p class="placeholder-text">News sentiment will appear after running predictions</p>
              </div>
            </div>
          </div>

          <!-- Combined Signal -->
          <div class="card combined-signal-card" id="combinedSignalCard" style="display:none">
            <h3>ğŸ”® Combined AI Signal</h3>
            <div id="combinedSignalContent"></div>
          </div>

          <div class="prediction-bottom">
            <div class="card">
              <h3>ğŸ¯ Recommended Strategy</h3>
              <div id="predStrategyContent">
                <p class="placeholder-text">Strategy recommendation will appear after prediction</p>
              </div>
              <canvas id="predPayoffChart" style="margin-top:16px"></canvas>
            </div>
            <div class="card">
              <h3>ğŸ”¬ Model Metrics</h3>
              <div id="modelMetrics">
                <p class="placeholder-text">Model details will appear after training</p>
              </div>
            </div>
          </div>

          <details class="edu-section card">
            <summary class="edu-toggle">ğŸ“š LSTM Neural Network Methodology & Formulas</summary>
            <div class="edu-content">
              <div class="edu-grid">
                <div class="edu-block">
                  <h4>ğŸ§  LSTM Neural Network</h4>
                  <p><strong>LSTM (Long Short-Term Memory)</strong> is a recurrent neural network designed to
                    learn patterns in sequential time-series data.</p>
                  <div class="edu-formula">Architecture: Input â†’ LSTM(32 units) â†’ Dense(16) â†’ Dense(1)<br><br>Gate
                    equations:<br>f_t = Ïƒ(W_f Â· [h_{t-1}, x_t] + b_f) â€” Forget gate<br>i_t = Ïƒ(W_i Â· [h_{t-1}, x_t] +
                    b_i) â€” Input gate<br>o_t = Ïƒ(W_o Â· [h_{t-1}, x_t] + b_o) â€” Output gate<br>C_t = f_t âŠ™ C_{t-1} + i_t
                    âŠ™ tanh(W_cÂ·[h_{t-1},x_t] + b_c)</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸ“Š Data Preparation</h4>
                  <div class="edu-formula">Normalization (Min-Max):<br>X_norm = (X âˆ’ X_min) / (X_max âˆ’
                    X_min)<br><br>Sliding windows:<br>Input: [P_t, P_{t+1}, ..., P_{t+lookback-1}]<br>Target:
                    P_{t+lookback}<br><br>Train/Val split: 80% / 20%</div>
                </div>
                <div class="edu-block">
                  <h4>ğŸ¯ Signal Generation</h4>
                  <div class="edu-formula">Signal = "Bullish" if Avg Forecast &gt; Current Price<br>Signal = "Bearish"
                    if
                    Avg Forecast &lt; Current Price<br><br>Confidence = min(|% Change| Ã— 10, 95)%<br><br>Combined Score
                    = 0.6 Ã— LSTM + 0.4 Ã— News Sentiment</div>
                </div>
                <div class="edu-block">
                  <h4>âš ï¸ Limitations</h4>
                  <p>â€¢ Trains on <strong>settlement prices only</strong> â€” no volume, OI, or fundamentals</p>
                  <p>â€¢ Sentiment uses <strong>keyword matching</strong> â€” not deep NLP</p>
                  <p>â€¢ Past patterns <strong>do not guarantee</strong> future results</p>
                  <p>â€¢ This is a <strong>proof of concept</strong> â€” not a trading system</p>
                </div>
              </div>
            </div>
          </details>
        </div>

      </section>

      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <!-- â•â•â• TAB 3: STRATEGY BUILDER (single page)            â•â•â• -->
      <!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
      <section class="tab-panel" id="panel-strategy">
        <div class="strategy-controls">
          <div class="card strategy-config">
            <h3>Strategy Configuration</h3>
            <div class="form-group">
              <label for="strategyType">Strategy</label>
              <select id="strategyType">
                <option value="covered-call">Covered Call</option>
                <option value="protective-put">Protective Put</option>
                <option value="collar">Collar</option>
                <option value="bull-spread">Bull Call Spread</option>
                <option value="bear-spread">Bear Put Spread</option>
                <option value="straddle">Long Straddle</option>
                <option value="strangle">Long Strangle</option>
              </select>
            </div>
            <div class="form-group">
              <label for="strategyExpiry">Expiry</label>
              <select id="strategyExpiry">
                <option value="">Select stock first</option>
              </select>
            </div>
            <div id="strategyLegs" class="strategy-legs"></div>
            <button class="btn btn-primary" id="buildStrategyBtn">Build Strategy</button>
          </div>
          <div class="card strategy-info">
            <h3>Strategy Summary</h3>
            <div id="strategySummary" class="strategy-summary">
              <p class="placeholder-text">Configure a strategy to see analysis</p>
            </div>
          </div>
        </div>
        <div class="card">
          <h3>Payoff Diagram</h3>
          <canvas id="payoffChart"></canvas>
        </div>
        <div class="card">
          <h3>Greeks Profile</h3>
          <div id="greeksDisplay" class="greeks-grid"></div>
        </div>

        <details class="edu-section card">
          <summary class="edu-toggle">ğŸ“š Strategy Formulas & Payoff Equations</summary>
          <div class="edu-content">
            <div class="edu-grid">
              <div class="edu-block">
                <h4>ğŸ”µ Covered Call</h4>
                <p><strong>Setup:</strong> Buy stock + Sell call at strike K</p>
                <div class="edu-formula">Payoff = (S âˆ’ Sâ‚€) + min(K âˆ’ S, 0) + C<br>Max Profit = (K âˆ’ Sâ‚€) + C<br>Max Loss
                  = Sâ‚€ âˆ’ C (if stock â†’ 0)<br>Breakeven = Sâ‚€ âˆ’ C</div>
                <p class="edu-hint">ğŸ“Œ Best when: Mildly bullish, want income from the premium</p>
              </div>
              <div class="edu-block">
                <h4>ğŸŸ¢ Protective Put</h4>
                <p><strong>Setup:</strong> Buy stock + Buy put at strike K</p>
                <div class="edu-formula">Payoff = (S âˆ’ Sâ‚€) + max(K âˆ’ S, 0) âˆ’ P<br>Max Profit = Unlimited (stock
                  upside)<br>Max Loss = Sâ‚€ âˆ’ K + P<br>Breakeven = Sâ‚€ + P</div>
                <p class="edu-hint">ğŸ“Œ Best when: Bullish but want insurance against a crash</p>
              </div>
              <div class="edu-block">
                <h4>ğŸŸ¡ Collar</h4>
                <p><strong>Setup:</strong> Buy stock + Buy put (Kâ‚) + Sell call (Kâ‚‚)</p>
                <div class="edu-formula">Payoff = (S âˆ’ Sâ‚€) + max(Kâ‚ âˆ’ S, 0) âˆ’ min(S âˆ’ Kâ‚‚, 0) âˆ’ P + C<br>Max Profit = Kâ‚‚
                  âˆ’ Sâ‚€ âˆ’ P + C<br>Max Loss = Sâ‚€ âˆ’ Kâ‚ + P âˆ’ C<br>Breakeven = Sâ‚€ + P âˆ’ C</div>
                <p class="edu-hint">ğŸ“Œ Best when: Want to cap both risk and reward at low cost</p>
              </div>
              <div class="edu-block">
                <h4>ğŸ”¼ Bull Call Spread</h4>
                <p><strong>Setup:</strong> Buy call (Kâ‚) + Sell call (Kâ‚‚), where Kâ‚ &lt; Kâ‚‚</p>
                <div class="edu-formula">Payoff = max(S âˆ’ Kâ‚, 0) âˆ’ max(S âˆ’ Kâ‚‚, 0) âˆ’ Net Debit<br>Max Profit = (Kâ‚‚ âˆ’ Kâ‚)
                  âˆ’ Net Debit<br>Max Loss = Net Debit<br>Breakeven = Kâ‚ + Net Debit</div>
                <p class="edu-hint">ğŸ“Œ Best when: Moderately bullish with defined risk</p>
              </div>
              <div class="edu-block">
                <h4>ğŸ”½ Bear Put Spread</h4>
                <p><strong>Setup:</strong> Buy put (Kâ‚‚) + Sell put (Kâ‚), where Kâ‚ &lt; Kâ‚‚</p>
                <div class="edu-formula">Payoff = max(Kâ‚‚ âˆ’ S, 0) âˆ’ max(Kâ‚ âˆ’ S, 0) âˆ’ Net Debit<br>Max Profit = (Kâ‚‚ âˆ’ Kâ‚)
                  âˆ’ Net Debit<br>Max Loss = Net Debit<br>Breakeven = Kâ‚‚ âˆ’ Net Debit</div>
                <p class="edu-hint">ğŸ“Œ Best when: Moderately bearish with defined risk</p>
              </div>
              <div class="edu-block">
                <h4>â¬†ï¸â¬‡ï¸ Long Straddle</h4>
                <p><strong>Setup:</strong> Buy call (K) + Buy put (K) at same strike</p>
                <div class="edu-formula">Payoff = max(S âˆ’ K, 0) + max(K âˆ’ S, 0) âˆ’ C âˆ’ P<br>Max Profit = Unlimited<br>Max
                  Loss = C + P (total premium paid)<br>Breakeven = K Â± (C + P)</div>
                <p class="edu-hint">ğŸ“Œ Best when: Expecting a BIG move but unsure of direction</p>
              </div>
              <div class="edu-block">
                <h4>â†•ï¸ Long Strangle</h4>
                <p><strong>Setup:</strong> Buy OTM put (Kâ‚) + Buy OTM call (Kâ‚‚), Kâ‚ &lt; Kâ‚‚</p>
                <div class="edu-formula">Payoff = max(Kâ‚ âˆ’ S, 0) + max(S âˆ’ Kâ‚‚, 0) âˆ’ P âˆ’ C<br>Max Profit =
                  Unlimited<br>Max Loss = P + C<br>Upper BE = Kâ‚‚ + (P + C)<br>Lower BE = Kâ‚ âˆ’ (P + C)</div>
                <p class="edu-hint">ğŸ“Œ Best when: Expecting a BIG move, cheaper than straddle</p>
              </div>
            </div>
          </div>
        </details>

        <details class="edu-section card">
          <summary class="edu-toggle">ğŸ“š The Greeks â€” Risk Sensitivities & Black-Scholes</summary>
          <div class="edu-content">
            <div class="edu-grid">
              <div class="edu-block">
                <h4>Î” Delta</h4>
                <p>How much the option price changes per $1 move in the stock.</p>
                <div class="edu-formula">Call Î” = N(dâ‚) âˆˆ [0, 1]<br>Put Î” = N(dâ‚) âˆ’ 1 âˆˆ [âˆ’1, 0]<br><br>Î” = 0.50 means:
                  stock up $1 â†’ option up $0.50</div>
              </div>
              <div class="edu-block">
                <h4>Î“ Gamma</h4>
                <p>How fast Delta changes as the stock moves. Highest for ATM options.</p>
                <div class="edu-formula">Î“ = N'(dâ‚) / (S Â· Ïƒ Â· âˆšT)<br><br>High Gamma = Delta swings rapidly with small
                  stock moves</div>
              </div>
              <div class="edu-block">
                <h4>Î˜ Theta</h4>
                <p>How much value the option loses per day due to time decay.</p>
                <div class="edu-formula">Î˜ = âˆ’[S Â· N'(dâ‚) Â· Ïƒ] / (2âˆšT) âˆ’ r Â· K Â· eâ»Ê³áµ€ Â· N(Â±dâ‚‚)<br><br>Almost always
                  negative â€” options lose value over time</div>
              </div>
              <div class="edu-block">
                <h4>Î½ Vega</h4>
                <p>How much the option price changes per 1% change in implied volatility.</p>
                <div class="edu-formula">Î½ = S Â· N'(dâ‚) Â· âˆšT<br><br>Higher Vega = more sensitive to volatility swings
                </div>
              </div>
              <div class="edu-block">
                <h4>ğŸ“ Black-Scholes Model</h4>
                <p>The foundational formula for option pricing (European options):</p>
                <div class="edu-formula">C = S Â· N(dâ‚) âˆ’ K Â· eâ»Ê³áµ€ Â· N(dâ‚‚)<br>P = K Â· eâ»Ê³áµ€ Â· N(âˆ’dâ‚‚) âˆ’ S Â·
                  N(âˆ’dâ‚)<br><br>where:<br>dâ‚ = [ln(S/K) + (r + ÏƒÂ²/2)T] / (ÏƒâˆšT)<br>dâ‚‚ = dâ‚ âˆ’ ÏƒâˆšT</div>
                <table class="edu-table">
                  <tr>
                    <td><strong>S</strong></td>
                    <td>Current stock price</td>
                  </tr>
                  <tr>
                    <td><strong>K</strong></td>
                    <td>Strike price</td>
                  </tr>
                  <tr>
                    <td><strong>T</strong></td>
                    <td>Time to expiry (in years)</td>
                  </tr>
                  <tr>
                    <td><strong>r</strong></td>
                    <td>Risk-free interest rate</td>
                  </tr>
                  <tr>
                    <td><strong>Ïƒ</strong></td>
                    <td>Volatility (standard deviation of returns)</td>
                  </tr>
                  <tr>
                    <td><strong>N(x)</strong></td>
                    <td>Cumulative standard normal distribution</td>
                  </tr>
                </table>
              </div>
            </div>
          </div>
        </details>
      </section>

    </main>

    <!-- Footer -->
    <footer class="app-footer">
      <p>Data source: HKEX DTOP Reports (Dec 2025 â€“ Feb 2026) Â· Settlement prices from SEOCH Â· Not financial advice</p>
    </footer>
  </div>

  <script>
    // Password gate â€” SHA-256 hash comparison (password not stored in plaintext)
    (function () {
      const HASH = 'cb4affc31bfeab6eaf9b2e6b034d2170b890056d30d1c85e229b8db1f3851eb0';
      async function sha256(str) {
        const buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(str));
        return Array.from(new Uint8Array(buf)).map(b => b.toString(16).padStart(2, '0')).join('');
      }
      function unlock() {
        document.getElementById('authGate').style.display = 'none';
        document.getElementById('app').style.display = '';
        sessionStorage.setItem('hk_auth', '1');
      }
      if (sessionStorage.getItem('hk_auth') === '1') { unlock(); }
      document.addEventListener('DOMContentLoaded', function () {
        const btn = document.getElementById('authSubmit');
        const inp = document.getElementById('authPassword');
        const err = document.getElementById('authError');
        async function check() {
          const h = await sha256(inp.value);
          if (h === HASH) { unlock(); } else { err.textContent = 'Incorrect password'; inp.value = ''; inp.focus(); }
        }
        btn.addEventListener('click', check);
        inp.addEventListener('keydown', function (e) { if (e.key === 'Enter') check(); });
        if (!sessionStorage.getItem('hk_auth')) inp.focus();
      });
    })();
  </script>
  <script type="module" src="/src/main.js"></script>
</body>

</html>