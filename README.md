# HK Stock & Option Explorer

A comprehensive web application for exploring Hong Kong stock options with multi-model AI price prediction, candlestick pattern detection, and news sentiment analysis â€” built entirely in the browser.

> **âš ï¸ DISCLAIMER**: This application is a **proof of concept** for educational and research purposes only. It is **NOT financial advice**. Options trading involves significant risk and may not be suitable for all investors. Past performance does not guarantee future results. The predictions generated by the AI models are experimental and should not be used as the sole basis for any investment decisions. Always consult with a qualified financial advisor before making investment decisions.

## Live Demo

Deployed on Netlify with automatic deployment from this repository.

**Password**: Required for access (contact the repository owner).

---

## Application Overview

The application follows a logical user workflow â€” **analyze stock prices first**, then **explore the options market**, and finally **build trading strategies**.

### Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Netlify (Static Site)                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Build Pipeline                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”             â”‚
â”‚  â”‚  yfinance   â”‚  â”‚ fetch_news.pyâ”‚  â”‚ fetch_prices â”‚             â”‚
â”‚  â”‚  (pip)      â”‚â†’ â”‚ (64 stocks)  â”‚â†’ â”‚  (64 stocks) â”‚             â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜             â”‚
â”‚                                          â†“                       â”‚
â”‚                                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚                                    â”‚vite buildâ”‚                  â”‚
â”‚                                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  Browser (All Computation Runs Client-Side)                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ Chart.js  â”‚ â”‚TensorFlow.js â”‚ â”‚  ARIMA   â”‚ â”‚  Sentiment   â”‚   â”‚
â”‚  â”‚ (Charts)  â”‚ â”‚ (LSTM Model) â”‚ â”‚  (WASM)  â”‚ â”‚  (Lexicon)   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚    Pre-built JSON Data (DTOP + News + Price History)     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Data Flow

1. **HKEX DTOP Data** â†’ Raw `.raw` files parsed by `build_data.js` â†’ 145 stock JSON files
2. **Yahoo Finance News** â†’ Fetched by `fetch_news.py` (yfinance) at build time â†’ 64 stock news JSON files
3. **Yahoo Finance Prices** â†’ Fetched by `fetch_prices.py` (yfinance) at build time â†’ 64 stock price JSON files
4. **Browser** loads pre-built JSON, runs SARIMAX/LSTM/Hybrid models in-browser, performs pattern detection and sentiment analysis

---

## Features (3 Tabs)

The UI is organized into **3 main tabs** with **sub-tabs** for logical grouping:

### ðŸ“Š Tab 1: Stock Analysis

Stock price prediction and pattern recognition.

#### ðŸ”® SARIMAX Price Prediction
- **LLM-Sentiment-Enhanced SARIMAX** vs **Traditional SARIMAX** â€” side-by-side comparison
- Uses the `arima` WASM library for in-browser ARIMA/SARIMAX computation
- News sentiment scores injected as exogenous variables to improve forecast accuracy
- Configurable forecast horizon (5, 10, 20, 30 days)
- Displays RMSE and MAPE metrics for both models
- Interactive forecast chart with confidence intervals

#### ðŸš€ Hybrid SARIMAX + LSTM
- **Three-model comparison**: Traditional SARIMAX vs Sentiment-Enhanced SARIMAX vs Hybrid (SARIMAX + LSTM)
- The hybrid model uses SARIMAX for the linear component and LSTM for residual non-linear patterns
- TensorFlow.js trains the LSTM model in-browser on SARIMAX residuals
- Configurable neurons, epochs, lookback window, and forecast horizon
- Model comparison table with RMSE and MAPE for all three approaches
- Shows whether adding news sentiment and deep learning improves forecast accuracy

#### ðŸ•¯ï¸ Candlestick Pattern Scanner
- Builds OHLC candles from settlement price data
- Detects 6 candlestick patterns: Doji, Hammer, Engulfing (Bullish/Bearish), Morning Star, Evening Star
- Pattern backtesting with win rate statistics
- Interactive candlestick chart with pattern overlay markers

---

### âš™ï¸ Tab 2: Options Explorer

Options market data, analysis, and AI-driven prediction.

#### ðŸ“‹ Dashboard
- Market overview with 145 HK stock option classes
- Top stocks ranked by total open interest
- Aggregate call/put OI and volume statistics
- Market overview bar chart

#### â›“ï¸ Options Chain
- Full options chain viewer with call/put data side by side
- Settlement prices, OI, volume, and price changes
- Filter by stock, date, and expiry
- Educational content on options basics, Greeks, and pricing

#### ðŸ“ˆ Trend Analysis
- Settlement price history over 52+ trading days
- Open interest evolution and volume analysis
- Put/Call ratio tracking
- Per-strike, per-expiry trend visualization

#### ðŸ¤– AI Prediction (LSTM + News Sentiment)

Two prediction models run **in parallel**:

| Model | Type | Speed | Input |
|-------|------|-------|-------|
| **LSTM** | TensorFlow.js neural network | ~17s training | Settlement price history |
| **News Sentiment** | Lexicon-based keyword scoring | Instant | Yahoo Finance headlines |

**LSTM Details:**
- Architecture: `LSTM(32) â†’ Dense(16) â†’ Dense(1)`
- Lookback window: 10 days (configurable)
- Forecast horizon: 5 days (configurable)
- Training: 50 epochs (configurable)

**News Sentiment:**
- Bullish/bearish financial keyword dictionary with weights
- Per-article scoring with color-coded sentiment dots
- Aggregate signal with confidence percentage

**Combined Signal:**
- 60% LSTM weight + 40% News weight
- Automatic strategy recommendation based on prediction direction

---

### ðŸŽ¯ Tab 3: Strategy Builder

- 7 option strategies: Covered Call, Protective Put, Collar, Bull/Bear Spreads, Straddle, Strangle
- Interactive payoff diagrams with Chart.js
- Risk metrics: max profit, max loss, breakeven points
- Aggregated Greeks: Delta, Gamma, Theta, Vega
- Entry price and strike selection from live options chain data

---

## Methodology & Formulas

Each section includes expandable educational content with full mathematical formulas:

- **Black-Scholes** pricing model and Greeks derivations
- **SARIMAX** order selection (p,d,q)(P,D,Q,s) and AIC/BIC criteria
- **LSTM** architecture, backpropagation through time, and loss functions
- **Hybrid model** residual learning theory
- **Candlestick pattern** recognition rules and backtesting methodology
- **Put/Call ratio** interpretation and trend indicators

---

## Tech Stack

| Component | Technology |
|-----------|-----------|
| **Frontend** | Vanilla JS + Vite |
| **Styling** | Custom CSS (Tableau-inspired light theme) |
| **Charts** | Chart.js 4.x |
| **ML (LSTM)** | TensorFlow.js (in-browser training & inference) |
| **ML (SARIMAX)** | arima (WASM-based ARIMA in-browser) |
| **News** | yfinance (build-time Python) |
| **Prices** | yfinance (build-time Python) |
| **Deployment** | Netlify (static site) |
| **Data** | HKEX DTOP settlement reports |

---

## Project Structure

```
â”œâ”€â”€ index.html              # Main HTML (3-tab layout with sub-tabs)
â”œâ”€â”€ netlify.toml             # Netlify build configuration
â”œâ”€â”€ package.json             # Node.js dependencies
â”œâ”€â”€ vite.config.js           # Vite bundler configuration
â”œâ”€â”€ .gitignore
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.js              # Application entry point + tab/sub-tab logic
â”‚   â”œâ”€â”€ index.css            # Full design system (Tableau light theme)
â”‚   â”œâ”€â”€ data.js              # Data layer (fetch + cache JSON)
â”‚   â”œâ”€â”€ charts.js            # Chart.js wrapper functions (10 chart types)
â”‚   â”œâ”€â”€ blackscholes.js      # Black-Scholes pricing model + Greeks
â”‚   â”œâ”€â”€ strategies.js        # Option strategy definitions + payoff calculator
â”‚   â”œâ”€â”€ lstm.js              # TensorFlow.js LSTM model (train + forecast)
â”‚   â”œâ”€â”€ sarimax.js           # SARIMAX pipeline (traditional + sentiment-enhanced)
â”‚   â”œâ”€â”€ hybrid.js            # Hybrid SARIMAX+LSTM residual model
â”‚   â”œâ”€â”€ candlestick.js       # OHLC builder, pattern detection, backtesting
â”‚   â””â”€â”€ sentiment.js         # Lexicon-based news sentiment analysis
â”‚
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ build_data.js        # DTOP .raw â†’ JSON data pipeline
â”‚   â”œâ”€â”€ fetch_news.py        # yfinance news fetcher (runs at build time)
â”‚   â”œâ”€â”€ fetch_prices.py      # yfinance price fetcher (runs at build time)
â”‚   â””â”€â”€ tickers.json         # Stock code â†’ Yahoo Finance ticker mapping
â”‚
â””â”€â”€ public/data/
    â”œâ”€â”€ index.json           # Stock metadata + dates
    â”œâ”€â”€ summary.json         # Daily market summary
    â”œâ”€â”€ {STOCK}.json         # Per-stock options data (145 files)
    â”œâ”€â”€ news/
    â”‚   â”œâ”€â”€ index.json       # News fetch metadata
    â”‚   â””â”€â”€ {STOCK}.json     # Per-stock news articles (64 files)
    â””â”€â”€ prices/
        â”œâ”€â”€ index.json       # Price fetch metadata
        â””â”€â”€ {STOCK}.json     # Per-stock historical prices (64 files)
```

---

## Local Development

```bash
# Install dependencies
npm install

# Run dev server
npm run dev

# Build for production
npm run build

# Fetch fresh news data (requires Python 3 + yfinance)
npm run build:news

# Full build (news + vite)
npm run build:full
```

## Netlify Deployment

The `netlify.toml` is pre-configured:

```toml
[build]
  command = "pip install yfinance -q && python3 scripts/fetch_news.py && npx vite build"
  publish = "dist"
```

Connect this repository to Netlify for automatic deployment. On each build, Netlify will:
1. Install yfinance via pip
2. Fetch latest news from Yahoo Finance for all 64 mapped stocks
3. Build the Vite production bundle
4. Deploy `dist/` as a static site

### Data Refresh

- **DTOP Data**: Pre-built and committed to the repository (Dec 2025 â€“ Feb 2026, 52 trading days)
- **News Data**: Refreshed on every Netlify build via `fetch_news.py`
- **Price Data**: Pre-built and committed (historical closing prices from Yahoo Finance)

---

## Data Source

All options data sourced from **HKEX DTOP (Daily Trading Overview of Products)** reports:
- **Period**: December 1, 2025 â€“ February 13, 2026 (52 trading days)
- **Coverage**: 145 stock option classes
- **Fields**: Open Interest, Volume, Settlement Price, Price Changes
- **Source**: Hong Kong Exchanges and Clearing Limited (HKEX)

Stock price data sourced from **Yahoo Finance** via the `yfinance` Python library.

---

## License

This project is for educational and research purposes only. Not for commercial use.

---

> **Reminder**: This is a proof of concept. Predictions are experimental. Do not trade based solely on this tool's output. Always do your own research and consult a financial professional.
